<template name="AdminArticleFiles">
    {{>AdminHeader header="Article PDF and XML"}}

    {{#if article}}

    {{>StatusModal}}

    {{#with article}}
    {{>AdminArticleHeader}}

    <div class="row">
        <div class="col s12">
            <div class="card z-depth-0">
                <div class="card-content">
                    <span class="card-title">Files</span>
                    <div class="row">
                        <div class="col s12">
                            {{#if files.xml}}
                            {{#with files}}<a class="btn" href="{{xml.url}}" target="_BLANK"><i class="material-icons">&#xE2C4;</i> XML</a>{{/with}}
                            {{else}}
                            No XML
                            {{/if}}
                            {{#if pfiles.df}}
                            {{#with files}}<a class="btn" href="{{pdf.url}}" target="_BLANK"><i class="material-icons">&#xE2C4;</i> PDF</a>{{/with}}
                            {{else}}
                            No PDF
                            {{/if}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col s12">
            <div class="card z-depth-0">
                <div class="card-content">
                    <form id="files-form">
                        <span class="card-title">File Settings</span>
                        <div class="row">
                            <div class="col s12 m6">
                                <fieldset>
                                    <legend>XML</legend>

                                    {{#if files.xml}}
                                    {{#with files}}
                                    {{#with xml}}
                                    {{#if url}}
                                    <input type="checkbox" id="display-xml" checked="{{checked display}}"/>
                                    <label for="display-xml">Display XML</label>
                                    {{else}}
                                    <p>No XML</p>
                                    {{/if}}
                                    {{/with}}
                                    {{/with}}
                                    {{else}}
                                    <p>No XML</p>
                                    {{/if}}
                                </fieldset>
                            </div>
                            <div class="col s12 m6">
                                <fieldset>
                                    <legend>PDF</legend>
                                    {{#if files.pdf}}
                                    {{#with files}}
                                    {{#with pdf}}
                                    {{#if url}}
                                    <input type="checkbox" id="display-pdf" checked="{{checked display}}"/>
                                    <label for="display-pdf">Display PDF</label>
                                    {{else}}
                                    <p>No PDF</p>
                                    {{/if}}
                                    {{/with}}
                                    {{/with}}
                                    {{else}}
                                    <p>No PDF</p>
                                    {{/if}}
                                </fieldset>
                            </div>
                        </div>
                        {{#with files}}
                        {{#if showFilesButton xml pdf}}
                        <div class="row">
                            <div class="col s12 center-align">
                            {{>SaveBtn what="Settings"}}
                            </div>
                        </div>
                        {{/if}}
                        {{/with}}
                    </form>
                </div>
            </div>
        </div>
    </div>
    {{/with}}

    {{else}}

    {{#if adminNotFound}}{{>Admin404 what="Article"}}{{/if}}

    {{/if}}
</template>

<template name="AdminArticleFilesUploader">
    {{>AdminHeader header="Article PDF and XML"}}

    {{#if article}}

    {{>StatusModal}}

    {{#with article}}

    {{>AdminArticleHeader}}

    {{/with}}

    {{#if verify}}
    {{else}}
    {{#with article}}
    <div class="row">
        <div class="col s12">
            <div class="card z-depth-0">
                <div class="card-content">
                    <div class="card-title">XML &amp; PDF Uploader</div>
                    {{>s3Upload}}
                </div>
            </div>
        </div>
    </div>
    {{/with}}
    {{/if}}

    {{#if verify}}{{>AdminArticleXmlVerify}}{{/if}}

    {{else}}

    {{#if adminNotFound}}{{>Admin404 what="Article"}}{{/if}}

    {{/if}}
</template>

<template name="AdminArticleXmlVerify">
    <div class="row">
        <div class="col s12">
            <div class="card z-depth-0">
                <div class="card-content">
                    {{#if article.aop}}

                    <div class="row">
                        <div class="col s12">
                            <h4>Verify AOP XML information below before saving to the database.</h4>
                            <p>AOP files are not stored, they are only used to update the database.</p>
                        </div>
                    </div>

                    {{else}}
                    <div class="row" id="xml-verify">
                        <div class="col s12">
                            <h4>Please verify the information below</h4>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <button id="xml-verified" class="btn btn-primary upload">{{>AdminUploadIcon}}</button> I have verified the XML. Upload the XML.
                        </div>
                    </div>

                    {{/if}}

                    <div class="row">
                        <div class="col s12">
                             <p>To update the database, save the form below.</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <button id="xml-verified" class="btn btn-cancel">{{>AdminCancelIcon}} Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {{>AdminArticleForm}}
</template>

<template name="AdminUploadArticleXml">
    {{>AdminHeader header="Article XML Uploader"}}
    {{>StatusModal}}
    {{#if article}}
    {{#with article}}
    <div class="row">
        <div class="col s12">
            <div class="card z-depth-0">
                <div class="card-content">
                    <div class="card-title">Verify Data</div>
                    {{>AdminArticleOverviewData}}
                    <div class="row">
                        <div class="col s2 right-align"><label>Figures:</label></div>
                        <div class="col s10">
                        {{#if files.figures}}
                        {{>AdminArticleFigOrSuppTable files=files.figures}}
                        {{else}}
                        N/A
                        {{/if}}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s2 right-align"><label>Supplemental Material:</label></div>
                        <div class="col s10">
                        {{#if files.supplemental}}
                        {{>AdminArticleFigOrSuppTable files=files.supplemental}}
                        {{else}}
                        N/A
                        {{/if}}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s6">
                            <button class="btn btn-submit" id="add-article">Add Article</button>
                        </div>
                        <div class="col s6 right-align">
                            <button class="btn btn-cancel" id="add-article-cancel">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {{/with}}
    {{else}}
    <div class="row">
        <div class="col s12">
            <div class="card z-depth-0">
                <div class="card-content">
                    <div class="card-title">Uploader</div>
                    {{>s3UploadNewArticle}}
                </div>
            </div>
        </div>
    </div>
    {{/if}}
</template>

<template name="AdminArticleFigOrSuppTable">
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Label</th>
                <th>Title</th>
                <th>Caption</th>
            </tr>
        </thead>
        <tbody>
            {{#each files}}
            <tr>
                <td>{{#if id}}{{id}}{{else}}&nbsp;{{/if}}</td>
                <td>{{#if label}}{{label}}{{else}}&nbsp;{{/if}}</td>
                <td>{{#if title}}{{{title}}}{{else}}&nbsp;{{/if}}</td>
                <td>{{#if caption}}{{{caption}}}{{else}}&nbsp;{{/if}}</td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</template>